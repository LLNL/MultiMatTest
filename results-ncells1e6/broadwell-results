Run stream benchmark for your system
L3 Cache on Macbook Pro is 6MB so problem size is just bigger at 16MB min
First test should give Stream Benchmark or problem size is too small
Second problem should give about twice the first
=======================================
Starting Single Material Data Structure
=======================================

GENMALLOC TOTAL:          Memory Size: 	   260000400 Bytes,  260000 KB,   260 MB

Average Density of pure cells    0.000000, compute time is 0.079120 msecs
Memory Operations  are 2.0 M memops, 16.0 Mbytes, 2.0 Mflops, 1.00:1 memops:flops
Estimated performance 1.20 msec, actual 0.08 msec, model error 1411.958740 %

Pressure Calculation for cell,             compute time is 0.052680 msecs
Memory Operations  are 4.0 M memops, 32.0 Mbytes, 3.0 Mflops, 1.33:1 memops:flops
Estimated performance 2.39 msec, actual 0.05 msec, model error 4441.616211 %


=================================================
Starting Cell-Dominant Full Matrix Data Structure
=================================================

Ratios to Full Data Structure
Sparsity 97.400261 percent/Filled 2.599736 percent

Ratios to Number of Cells
Pure cell 80.007202 percentage/Mixed material 19.992800 percentage

Ratios to Mixed Material Data Structure
Mixed material Sparsity 4.999760 percent/Mixed material Filled 95.000237 percent

1 matcell 800072 2 matcell 125088 3 matcell 49740 4 matcell 25100 5 matcell 0

GENMALLOC TOTAL:          Memory Size: 	  1892000400 Bytes, 1892000 KB,  1892 MB

Average Density of mixed material cells    compute time is 14.627830 msecs
Memory Operations  are 102.0 M memops, 816.0 Mbytes, 100.0 Mflops, 1.02:1 memops:flops
Estimated performance 61.01 msec, actual 14.63 msec, model error 317.077240 %

Average Density of frac with if            compute time is 14.574230 msecs
Memory Operations  are 53.3 M memops, 426.4 Mbytes, 3.6 Mflops, 14.81:1 memops:flops
Estimated performance 93.50 msec, actual 14.57 msec, model error 541.568542 %

Pressure Calculation of mixed material cells with if compute time is 30.474430 msecs
Memory Operations  are 103.9 M memops, 831.2 Mbytes, 3.9 Mflops, 26.64:1 memops:flops
Estimated performance 123.77 msec, actual 30.47 msec, model error 306.140259 %

Average Material Density            compute time is 1053.474121 msecs
Memory Operations  are 400.4 M memops, 3203.1 Mbytes, 79.2 Mflops, 5.06:1 memops:flops
Estimated performance 301.10 msec, actual 1053.47 msec, model error -71.417915 %


===================================================
Starting Material-Dominant Full Matrix Data Structure
===================================================
Ratios to Full Data Structure
Sparsity 97.400261 percent/Filled 2.599736 percent

Ratios to Number of Cells
Pure cell 80.007202 percentage/Mixed material 19.992800 percentage

Ratios to Mixed Material Data Structure
Mixed material Sparsity 4.999760 percent/Mixed material Filled 95.000237 percent

1 matcell 800072 2 matcell 125088 3 matcell 49740 4 matcell 25100 5 matcell 0

GENMALLOC TOTAL:          Memory Size: 	  1860002000 Bytes, 1860002 KB,  1860 MB

Average Density of mixed material cells    compute time is 14.417950 msecs
Memory Operations  are 153.0 M memops, 1224.0 Mbytes, 101.0 Mflops, 1.51:1 memops:flops
Estimated performance 91.51 msec, actual 14.42 msec, model error 534.722839 %

Average Density of mixed material cells with if compute time is 10.651620 msecs
Memory Operations  are 55.6 M memops, 444.8 Mbytes, 3.6 Mflops, 15.45:1 memops:flops
Estimated performance 94.88 msec, actual 10.65 msec, model error 790.749817 %

Pressure Calculation of frac with if       compute time is 28.595180 msecs
Memory Operations  are 102.6 M memops, 820.8 Mbytes, 3.9 Mflops, 26.31:1 memops:flops
Estimated performance 122.99 msec, actual 28.60 msec, model error 330.112579 %

Average Material Density            compute time is 16.710760 msecs
Memory Operations  are 440.6 M memops, 3524.5 Mbytes, 94.9 Mflops, 4.64:1 memops:flops
Estimated performance 325.14 msec, actual 16.71 msec, model error 1845.687134 %


===================================================
Starting Cell-Dominant Compact Data Structure
===================================================
Ratios to Full Data Structure
Sparsity 97.400261 percent/Filled 2.599736 percent

Ratios to Number of Cells
Pure cell 80.007202 percentage/Mixed material 19.992800 percentage

Ratios to Mixed Material Data Structure
Mixed material Sparsity 4.999760 percent/Mixed material Filled 95.000237 percent

1 matcell 800072 2 matcell 125088 3 matcell 49740 4 matcell 25100 5 matcell 0

GENMALLOC TOTAL:          Memory Size: 	   289991424 Bytes,  289991 KB,   289 MB

Average Density of mixed material cells    compute time is 0.104320 msecs
Memory Operations  are 1.1 M memops, 4.4 Mbytes, 0.0 Mflops, 23.91:1 memops:flops
Estimated performance 0.33 msec, actual 0.10 msec, model error 218.655777 %

Average Density of mixed material cells with nmats  compute time is 0.118710 msecs
Memory Operations  are 1.0 M memops, 4.4 Mbytes, 0.0 Mflops, 23.41:1 memops:flops
Estimated performance 0.33 msec, actual 0.12 msec, model error 174.408600 %

Average Density of mixed material cells    compute time is 0.100700 msecs
Memory Operations  are 1.1 M memops, 4.4 Mbytes, 0.0 Mflops, 23.91:1 memops:flops
Estimated performance 0.33 msec, actual 0.10 msec, model error 230.110931 %

Average Density of mixed materials cells pure filler  compute time is 0.104870 msecs
Memory Operations  are 1.1 M memops, 4.4 Mbytes, 0.0 Mflops, 23.91:1 memops:flops
Estimated performance 0.33 msec, actual 0.10 msec, model error 216.984558 %

Pressure Calculation of mixed material cells compute time is 0.118160 msecs
Memory Operations  are 1.1 M memops, 4.9 Mbytes, 0.1 Mflops, 16.94:1 memops:flops
Estimated performance 0.37 msec, actual 0.12 msec, model error 209.561569 %

Average Material Density            compute time is 10.210410 msecs
Memory Operations  are 199.2 M memops, 1594.0 Mbytes, 80.5 Mflops, 2.48:1 memops:flops
Estimated performance 119.18 msec, actual 10.21 msec, model error 1067.206177 %


===================================================
Starting Material-Centric Compact Data Structure
===================================================
Ratios to Full Data Structure
Sparsity 97.400261 percent/Filled 2.599736 percent

Ratios to Number of Cells
Pure cell 80.007202 percentage/Mixed material 19.992800 percentage

Ratios to Mixed Material Data Structure
Mixed material Sparsity 4.999760 percent/Mixed material Filled 95.000237 percent

1 matcell 800072 2 matcell 125088 3 matcell 49740 4 matcell 25100 5 matcell 0

GENMALLOC TOTAL:          Memory Size: 	   510798248 Bytes,  510798 KB,   510 MB

Average Density of cells - Mat Dominant loop  -  compute time is 0.463250 msecs
Memory Operations  are 19.6 M memops, 151.6 Mbytes, 3.6 Mflops, 5.44:1 memops:flops
Estimated performance 11.33 msec, actual 0.46 msec, model error 2346.556152 %

Average Density of cells - Cell Dominant loop  -  compute time is 1.261220 msecs
Memory Operations  are 45.9 M memops, 274.8 Mbytes, 3.6 Mflops, 12.75:1 memops:flops
Estimated performance 20.54 msec, actual 1.26 msec, model error 1528.887817 %

Pressure Calculation of cells - Mat-Centric -  compute time is 0.261120 msecs
Memory Operations  are 5.2 M memops, 41.6 Mbytes, 3.9 Mflops, 1.33:1 memops:flops
Estimated performance 3.11 msec, actual 0.26 msec, model error 1091.021240 %

Average Material Density  -  compute time is 12.852140 msecs
Memory Operations  are 341.2 M memops, 2729.4 Mbytes, 83.2 Mflops, 4.10:1 memops:flops
Estimated performance 204.06 msec, actual 12.85 msec, model error 1487.786621 %

Conversion from compact material data structure to compact cell data structure
Memory Operations  are 68.0 M memops, 344.0 Mbytes, 0.0 Mflops, inf:1 memops:flops
Estimated performance 25.72 msec, actual 39.66 msec, model error -35.149902 %

Ratios to Full Data Structure
Sparsity 97.400261 percent/Filled 2.599736 percent

Ratios to Number of Cells
Pure cell 80.007202 percentage/Mixed material 19.992800 percentage

Ratios to Mixed Material Data Structure
Mixed material Sparsity 4.999760 percent/Mixed material Filled 95.000237 percent

1 matcell 800072 2 matcell 125088 3 matcell 49740 4 matcell 25100 5 matcell 0

Conversion from compact cell data structure to compact material data structure
Memory Operations  are 140.5 M memops, 724.0 Mbytes, 0.0 Mflops, inf:1 memops:flops
Estimated performance 54.13 msec, actual 205.93 msec, model error -73.713341 %

Application 564592 resources: utime ~825s, stime ~19s, Rss ~2220452, inblocks ~0, outblocks ~0
